[2024-11-28 18:30:27,417] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/home/scur2847/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading data...
Loaded 1713 examples from 9 languages: {'finnish', 'korean', 'bengali', 'indonesian', 'telugu', 'english', 'arabic', 'swahili', 'russian'}
Loading model and tokenizer...
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:05<00:05,  5.74s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.57s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:07<00:00,  3.89s/it]
loaded the peft model
Convert model to bfloat16 precision.
Generating Completions:   0%|          | 0/1713 [00:00<?, ?it/s]Generating Completions:   1%|          | 20/1713 [00:02<04:11,  6.74it/s]Generating Completions:   2%|▏         | 40/1713 [00:05<03:22,  8.27it/s]Generating Completions:   4%|▎         | 60/1713 [00:07<03:06,  8.87it/s]Generating Completions:   5%|▍         | 80/1713 [00:08<02:43,  9.98it/s]Generating Completions:   6%|▌         | 100/1713 [00:10<02:28, 10.85it/s]Generating Completions:   7%|▋         | 120/1713 [00:12<02:36, 10.17it/s]Generating Completions:   8%|▊         | 140/1713 [00:14<02:36, 10.03it/s]Generating Completions:   9%|▉         | 160/1713 [00:15<02:22, 10.90it/s]Generating Completions:  11%|█         | 180/1713 [00:18<02:27, 10.39it/s]Generating Completions:  12%|█▏        | 200/1713 [00:19<02:14, 11.25it/s]Generating Completions:  13%|█▎        | 220/1713 [00:22<02:43,  9.13it/s]Generating Completions:  14%|█▍        | 240/1713 [00:25<02:59,  8.22it/s]Generating Completions:  15%|█▌        | 260/1713 [00:28<03:06,  7.80it/s]Generating Completions:  16%|█▋        | 280/1713 [00:31<03:13,  7.42it/s]Generating Completions:  18%|█▊        | 300/1713 [00:34<03:17,  7.17it/s]Generating Completions:  19%|█▊        | 320/1713 [00:37<03:18,  7.01it/s]Generating Completions:  20%|█▉        | 340/1713 [00:40<03:19,  6.90it/s]Generating Completions:  21%|██        | 360/1713 [00:43<03:18,  6.83it/s]Generating Completions:  22%|██▏       | 380/1713 [00:46<03:18,  6.72it/s]Generating Completions:  23%|██▎       | 400/1713 [00:49<03:15,  6.71it/s]Generating Completions:  25%|██▍       | 420/1713 [00:53<03:30,  6.14it/s]Generating Completions:  26%|██▌       | 440/1713 [00:57<03:35,  5.90it/s]Generating Completions:  27%|██▋       | 460/1713 [01:00<03:37,  5.77it/s]Generating Completions:  28%|██▊       | 480/1713 [01:04<03:38,  5.65it/s]Generating Completions:  29%|██▉       | 500/1713 [01:08<03:36,  5.60it/s]Generating Completions:  30%|███       | 520/1713 [01:12<03:37,  5.49it/s]Generating Completions:  32%|███▏      | 540/1713 [01:14<03:08,  6.24it/s]Generating Completions:  33%|███▎      | 560/1713 [01:16<02:49,  6.79it/s]Generating Completions:  34%|███▍      | 580/1713 [01:18<02:36,  7.23it/s]Generating Completions:  35%|███▌      | 600/1713 [01:21<02:28,  7.50it/s]Generating Completions:  36%|███▌      | 620/1713 [01:23<02:22,  7.70it/s]Generating Completions:  37%|███▋      | 640/1713 [01:26<02:14,  7.96it/s]Generating Completions:  39%|███▊      | 660/1713 [01:28<02:06,  8.32it/s]Generating Completions:  40%|███▉      | 680/1713 [01:30<02:04,  8.30it/s]Generating Completions:  41%|████      | 700/1713 [01:33<02:02,  8.27it/s]Generating Completions:  42%|████▏     | 720/1713 [01:37<02:26,  6.79it/s]Generating Completions:  43%|████▎     | 740/1713 [01:41<02:42,  5.99it/s]Generating Completions:  44%|████▍     | 760/1713 [01:45<02:51,  5.56it/s]Generating Completions:  46%|████▌     | 780/1713 [01:49<02:56,  5.30it/s]Generating Completions:  47%|████▋     | 800/1713 [01:54<03:02,  5.01it/s]Generating Completions:  48%|████▊     | 820/1713 [01:58<03:03,  4.86it/s]Generating Completions:  49%|████▉     | 840/1713 [02:03<03:01,  4.81it/s]Generating Completions:  50%|█████     | 860/1713 [02:07<02:58,  4.79it/s]Generating Completions:  51%|█████▏    | 880/1713 [02:11<02:55,  4.75it/s]Generating Completions:  53%|█████▎    | 900/1713 [02:15<02:52,  4.72it/s]Generating Completions:  54%|█████▎    | 920/1713 [02:20<02:47,  4.74it/s]Generating Completions:  55%|█████▍    | 940/1713 [02:21<02:13,  5.77it/s]Generating Completions:  56%|█████▌    | 960/1713 [02:22<01:44,  7.22it/s]Generating Completions:  57%|█████▋    | 980/1713 [02:24<01:28,  8.31it/s]Generating Completions:  58%|█████▊    | 1000/1713 [02:25<01:13,  9.68it/s]Generating Completions:  60%|█████▉    | 1020/1713 [02:27<01:08, 10.16it/s]Generating Completions:  61%|██████    | 1040/1713 [02:28<00:56, 11.99it/s]Generating Completions:  62%|██████▏   | 1060/1713 [02:29<00:50, 12.82it/s]Generating Completions:  63%|██████▎   | 1080/1713 [02:30<00:45, 14.05it/s]Generating Completions:  64%|██████▍   | 1100/1713 [02:32<00:42, 14.51it/s]Generating Completions:  65%|██████▌   | 1120/1713 [02:35<00:55, 10.66it/s]Generating Completions:  67%|██████▋   | 1140/1713 [02:38<01:07,  8.53it/s]Generating Completions:  68%|██████▊   | 1160/1713 [02:41<01:07,  8.22it/s]Generating Completions:  69%|██████▉   | 1180/1713 [02:44<01:12,  7.33it/s]Generating Completions:  70%|███████   | 1200/1713 [02:48<01:15,  6.80it/s]Generating Completions:  71%|███████   | 1220/1713 [02:51<01:15,  6.49it/s]Generating Completions:  72%|███████▏  | 1240/1713 [02:54<01:15,  6.28it/s]Generating Completions:  74%|███████▎  | 1260/1713 [02:58<01:13,  6.15it/s]Generating Completions:  75%|███████▍  | 1280/1713 [03:01<01:11,  6.05it/s]Generating Completions:  76%|███████▌  | 1300/1713 [03:05<01:09,  5.98it/s]Generating Completions:  77%|███████▋  | 1320/1713 [03:08<01:06,  5.95it/s]Generating Completions:  78%|███████▊  | 1340/1713 [03:09<00:51,  7.26it/s]Generating Completions:  79%|███████▉  | 1360/1713 [03:11<00:43,  8.07it/s]Generating Completions:  81%|████████  | 1380/1713 [03:14<00:40,  8.27it/s]Generating Completions:  82%|████████▏ | 1400/1713 [03:16<00:35,  8.76it/s]Generating Completions:  83%|████████▎ | 1420/1713 [03:17<00:28, 10.16it/s]Generating Completions:  84%|████████▍ | 1440/1713 [03:19<00:27, 10.10it/s]Generating Completions:  85%|████████▌ | 1460/1713 [03:21<00:26,  9.71it/s]Generating Completions:  86%|████████▋ | 1480/1713 [03:23<00:24,  9.69it/s]Generating Completions:  88%|████████▊ | 1500/1713 [03:25<00:20, 10.33it/s]Generating Completions:  89%|████████▊ | 1520/1713 [03:27<00:19, 10.04it/s]Generating Completions:  90%|████████▉ | 1540/1713 [03:29<00:17, 10.16it/s]Generating Completions:  91%|█████████ | 1560/1713 [03:31<00:15,  9.66it/s]Generating Completions:  92%|█████████▏| 1580/1713 [03:32<00:11, 11.78it/s]Generating Completions:  93%|█████████▎| 1600/1713 [03:34<00:10, 10.65it/s]Generating Completions:  95%|█████████▍| 1620/1713 [03:36<00:09, 10.26it/s]Generating Completions:  96%|█████████▌| 1640/1713 [03:38<00:06, 10.96it/s]Generating Completions:  97%|█████████▋| 1660/1713 [03:40<00:05, 10.13it/s]Generating Completions:  98%|█████████▊| 1680/1713 [03:42<00:03, 10.37it/s]Generating Completions:  99%|█████████▉| 1700/1713 [03:44<00:01,  9.85it/s]Generating Completions: 100%|██████████| 1713/1713 [03:46<00:00,  8.86it/s]Generating Completions: 100%|██████████| 1713/1713 [03:46<00:00,  7.55it/s]
Calculating F1, EM ...
Downloading builder script:   0%|          | 0.00/4.53k [00:00<?, ?B/s]Downloading builder script: 100%|██████████| 4.53k/4.53k [00:00<00:00, 27.5MB/s]
Downloading extra modules:   0%|          | 0.00/3.32k [00:00<?, ?B/s]Downloading extra modules: 100%|██████████| 3.32k/3.32k [00:00<00:00, 23.9MB/s]
Scores:
{
    "finnish": {
        "exact_match": 50.5,
        "f1": 66.93650662050115
    },
    "korean": {
        "exact_match": 30.0,
        "f1": 44.12677345743591
    },
    "bengali": {
        "exact_match": 23.008849557522122,
        "f1": 35.47127405534484
    },
    "indonesian": {
        "exact_match": 45.5,
        "f1": 73.11177642310138
    },
    "telugu": {
        "exact_match": 2.0,
        "f1": 5.185714285714287
    },
    "english": {
        "exact_match": 56.5,
        "f1": 76.06953262589876
    },
    "arabic": {
        "exact_match": 25.5,
        "f1": 54.5078433193387
    },
    "swahili": {
        "exact_match": 40.0,
        "f1": 57.9837665466921
    },
    "russian": {
        "exact_match": 24.5,
        "f1": 55.00445832943146
    },
    "average": {
        "f1": 52.04418285149539,
        "exact_match": 33.05653883972468
    }
}
Done!
tydiqa Evaluation Result: 52.04418285149539%

JOB STATISTICS
==============
Job ID: 8811936
Cluster: snellius
User/Group: scur2847/scur2847
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:05:27
CPU Efficiency: 7.71% of 01:10:40 core-walltime
Job Wall-clock time: 00:04:25
Memory Utilized: 1.65 GB
Memory Efficiency: 0.92% of 180.00 GB
