[2024-12-01 23:22:58,950] [INFO] [real_accelerator.py:203:get_accelerator] Setting ds_accelerator to cuda (auto detect)
/home/scur2847/.local/lib/python3.11/site-packages/huggingface_hub/file_download.py:797: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
INFO:accelerate.utils.modeling:We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
Loading data...
Loaded 1713 examples from 9 languages: {'indonesian', 'finnish', 'swahili', 'english', 'arabic', 'russian', 'bengali', 'korean', 'telugu'}
Loading model and tokenizer...
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:06<00:12,  6.35s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:12<00:06,  6.33s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.60s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:17<00:00,  5.80s/it]
loaded the peft model
Convert model to bfloat16 precision.
Generating Completions:   0%|          | 0/1713 [00:00<?, ?it/s]Generating Completions:   1%|          | 20/1713 [00:03<05:30,  5.13it/s]Generating Completions:   2%|▏         | 40/1713 [00:07<05:30,  5.07it/s]Generating Completions:   4%|▎         | 60/1713 [00:11<05:25,  5.08it/s]Generating Completions:   5%|▍         | 80/1713 [00:15<05:20,  5.09it/s]Generating Completions:   6%|▌         | 100/1713 [00:19<05:10,  5.19it/s]Generating Completions:   7%|▋         | 120/1713 [00:23<05:08,  5.16it/s]Generating Completions:   8%|▊         | 140/1713 [00:25<04:23,  5.96it/s]Generating Completions:   9%|▉         | 160/1713 [00:29<04:35,  5.64it/s]Generating Completions:  11%|█         | 180/1713 [00:33<04:31,  5.64it/s]Generating Completions:  12%|█▏        | 200/1713 [00:37<04:37,  5.45it/s]Generating Completions:  13%|█▎        | 220/1713 [00:39<04:16,  5.82it/s]Generating Completions:  14%|█▍        | 240/1713 [00:43<04:16,  5.75it/s]Generating Completions:  15%|█▌        | 260/1713 [00:47<04:14,  5.71it/s]Generating Completions:  16%|█▋        | 280/1713 [00:50<04:10,  5.72it/s]Generating Completions:  18%|█▊        | 300/1713 [00:53<03:48,  6.19it/s]Generating Completions:  19%|█▊        | 320/1713 [00:56<03:46,  6.15it/s]Generating Completions:  20%|█▉        | 340/1713 [00:58<03:22,  6.79it/s]Generating Completions:  21%|██        | 360/1713 [01:01<03:14,  6.96it/s]Generating Completions:  22%|██▏       | 380/1713 [01:04<03:15,  6.83it/s]Generating Completions:  23%|██▎       | 400/1713 [01:07<03:16,  6.69it/s]Generating Completions:  25%|██▍       | 420/1713 [01:08<02:38,  8.16it/s]Generating Completions:  26%|██▌       | 440/1713 [01:10<02:25,  8.77it/s]Generating Completions:  27%|██▋       | 460/1713 [01:12<02:05,  9.96it/s]Generating Completions:  28%|██▊       | 480/1713 [01:13<01:52, 11.00it/s]Generating Completions:  29%|██▉       | 500/1713 [01:16<02:17,  8.80it/s]Generating Completions:  30%|███       | 520/1713 [01:18<01:57, 10.14it/s]Generating Completions:  32%|███▏      | 540/1713 [01:19<01:44, 11.26it/s]Generating Completions:  33%|███▎      | 560/1713 [01:20<01:33, 12.37it/s]Generating Completions:  34%|███▍      | 580/1713 [01:22<01:42, 11.04it/s]Generating Completions:  35%|███▌      | 600/1713 [01:24<01:36, 11.53it/s]Generating Completions:  36%|███▌      | 620/1713 [01:27<01:49,  9.99it/s]Generating Completions:  37%|███▋      | 640/1713 [01:29<02:01,  8.82it/s]Generating Completions:  39%|███▊      | 660/1713 [01:33<02:14,  7.86it/s]Generating Completions:  40%|███▉      | 680/1713 [01:36<02:23,  7.20it/s]Generating Completions:  41%|████      | 700/1713 [01:38<02:06,  8.00it/s]Generating Completions:  42%|████▏     | 720/1713 [01:39<01:46,  9.29it/s]Generating Completions:  43%|████▎     | 740/1713 [01:41<01:38,  9.88it/s]Generating Completions:  44%|████▍     | 760/1713 [01:42<01:29, 10.65it/s]Generating Completions:  46%|████▌     | 780/1713 [01:44<01:19, 11.68it/s]Generating Completions:  47%|████▋     | 800/1713 [01:46<01:19, 11.52it/s]Generating Completions:  48%|████▊     | 820/1713 [01:51<02:09,  6.89it/s]Generating Completions:  49%|████▉     | 840/1713 [01:57<02:42,  5.39it/s]Generating Completions:  50%|█████     | 860/1713 [02:02<03:02,  4.68it/s]Generating Completions:  51%|█████▏    | 880/1713 [02:08<03:13,  4.30it/s]Generating Completions:  53%|█████▎    | 900/1713 [02:13<03:20,  4.06it/s]Generating Completions:  54%|█████▎    | 920/1713 [02:19<03:22,  3.92it/s]Generating Completions:  55%|█████▍    | 940/1713 [02:24<03:21,  3.83it/s]Generating Completions:  56%|█████▌    | 960/1713 [02:30<03:20,  3.76it/s]Generating Completions:  57%|█████▋    | 980/1713 [02:36<03:17,  3.72it/s]Generating Completions:  58%|█████▊    | 1000/1713 [02:41<03:14,  3.67it/s]Generating Completions:  60%|█████▉    | 1020/1713 [02:43<02:30,  4.61it/s]Generating Completions:  61%|██████    | 1040/1713 [02:45<02:06,  5.33it/s]Generating Completions:  62%|██████▏   | 1060/1713 [02:48<01:56,  5.59it/s]Generating Completions:  63%|██████▎   | 1080/1713 [02:52<01:54,  5.54it/s]Generating Completions:  64%|██████▍   | 1100/1713 [02:55<01:47,  5.72it/s]Generating Completions:  65%|██████▌   | 1120/1713 [02:58<01:37,  6.06it/s]Generating Completions:  67%|██████▋   | 1140/1713 [03:00<01:18,  7.30it/s]Generating Completions:  68%|██████▊   | 1160/1713 [03:03<01:23,  6.60it/s]Generating Completions:  69%|██████▉   | 1180/1713 [03:07<01:23,  6.36it/s]Generating Completions:  70%|███████   | 1200/1713 [03:09<01:11,  7.22it/s]Generating Completions:  71%|███████   | 1220/1713 [03:15<01:34,  5.23it/s]Generating Completions:  72%|███████▏  | 1240/1713 [03:21<01:45,  4.47it/s]Generating Completions:  74%|███████▎  | 1260/1713 [03:27<01:51,  4.08it/s]Generating Completions:  75%|███████▍  | 1280/1713 [03:33<01:53,  3.82it/s]Generating Completions:  76%|███████▌  | 1300/1713 [03:39<01:52,  3.68it/s]Generating Completions:  77%|███████▋  | 1320/1713 [03:45<01:51,  3.54it/s]Generating Completions:  78%|███████▊  | 1340/1713 [03:50<01:40,  3.70it/s]Generating Completions:  79%|███████▉  | 1360/1713 [03:53<01:22,  4.30it/s]Generating Completions:  81%|████████  | 1380/1713 [03:57<01:17,  4.29it/s]Generating Completions:  82%|████████▏ | 1400/1713 [04:02<01:11,  4.38it/s]Generating Completions:  83%|████████▎ | 1420/1713 [04:06<01:04,  4.58it/s]Generating Completions:  84%|████████▍ | 1440/1713 [04:10<01:01,  4.43it/s]Generating Completions:  85%|████████▌ | 1460/1713 [04:15<00:58,  4.35it/s]Generating Completions:  86%|████████▋ | 1480/1713 [04:20<00:54,  4.29it/s]Generating Completions:  88%|████████▊ | 1500/1713 [04:25<00:50,  4.23it/s]Generating Completions:  89%|████████▊ | 1520/1713 [04:32<00:52,  3.69it/s]Generating Completions:  90%|████████▉ | 1540/1713 [04:39<00:50,  3.42it/s]Generating Completions:  91%|█████████ | 1560/1713 [04:45<00:46,  3.28it/s]Generating Completions:  92%|█████████▏| 1580/1713 [04:53<00:42,  3.13it/s]Generating Completions:  93%|█████████▎| 1600/1713 [05:00<00:37,  3.01it/s]Generating Completions:  95%|█████████▍| 1620/1713 [05:07<00:31,  2.95it/s]Generating Completions:  96%|█████████▌| 1640/1713 [05:14<00:25,  2.91it/s]Generating Completions:  97%|█████████▋| 1660/1713 [05:21<00:18,  2.92it/s]Generating Completions:  98%|█████████▊| 1680/1713 [05:28<00:11,  2.91it/s]Generating Completions:  99%|█████████▉| 1700/1713 [05:34<00:04,  2.92it/s]Generating Completions: 100%|██████████| 1713/1713 [05:39<00:00,  2.89it/s]Generating Completions: 100%|██████████| 1713/1713 [05:39<00:00,  5.04it/s]
Calculating F1, EM ...
Scores:
{
    "indonesian": {
        "exact_match": 48.0,
        "f1": 75.26134634432245
    },
    "finnish": {
        "exact_match": 52.5,
        "f1": 72.98675850540948
    },
    "swahili": {
        "exact_match": 50.5,
        "f1": 60.53660389318286
    },
    "english": {
        "exact_match": 64.5,
        "f1": 76.73538449171885
    },
    "arabic": {
        "exact_match": 30.0,
        "f1": 58.755199230404706
    },
    "russian": {
        "exact_match": 39.5,
        "f1": 63.85934323149728
    },
    "bengali": {
        "exact_match": 28.31858407079646,
        "f1": 39.335900088112474
    },
    "korean": {
        "exact_match": 55.0,
        "f1": 66.73176561533707
    },
    "telugu": {
        "exact_match": 4.0,
        "f1": 6.824999999999999
    },
    "average": {
        "f1": 57.891922377776126,
        "exact_match": 41.36873156342183
    }
}
Done!
tydiqa Evaluation Result: 57.891922377776126%

JOB STATISTICS
==============
Job ID: 8874439
Cluster: snellius
User/Group: scur2847/scur2847
State: COMPLETED (exit code 0)
Nodes: 1
Cores per node: 16
CPU Utilized: 00:08:57
CPU Efficiency: 8.41% of 01:46:24 core-walltime
Job Wall-clock time: 00:06:39
Memory Utilized: 2.78 GB
Memory Efficiency: 1.54% of 180.00 GB
